<!DOCTYPE html>
<meta charset="utf-8">
<title>Battery Status Demo</title>

<div id="log"></div>

<script>
(function() {

  var logBatteryStatus = function (battery, eventtype) {
    var message = "";
    if (arguments.length === 2) {
      message += "Event: " + eventtype + " ";
    }
    message += "{charging: " + battery.charging +
               ", chargingTime: " + battery.chargingTime +
               ", dischargingTime: " + battery.dischargingTime +
               ", level: " + battery.level +
               "}";
    document.querySelector("#log").innerHTML += message + "<br/>";
  };

  var batterySuccess = function (battery) {
    // Update the battery status initially when the promise resolves ...
    logBatteryStatus(battery);

    // .. and for any subsequent updates.
    battery.onchargingchange = function () {
      logBatteryStatus(battery, "chargingchange");
    };

    battery.onchargingtimechange = function () {
      logBatteryStatus(battery, "chargingtimechange");
    };

    battery.ondischargingtimechange = function () {
      logBatteryStatus(battery, "dischargingtimechange");
    };

    battery.onlevelchange = function () {
      logBatteryStatus(battery, "levelchange");
    };
  };

  var batteryFailure = function (error) {
    document.querySelector("#log").innerHTML += error.message + "<br/>";
  };
      
  navigator.getBattery().then(batterySuccess, batteryFailure);

})();
</script>

